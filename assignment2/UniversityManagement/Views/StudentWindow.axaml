<Window
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="clr-namespace:UniversityManagement.ViewModels"
    x:Class="UniversityManagement.Views.StudentWindow"
    x:DataType="vm:StudentWindowViewModel"
    Title="Student Dashboard"
    Width="1200"
    Height="800">

    <Panel Background="#000000">
        <!-- Main container with fixed width and centered -->
        <Grid Margin="30" RowDefinitions="Auto,*">
            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="Student Dashboard" FontSize="24" FontWeight="Bold"/>
                <TextBlock Text="{Binding TemplateStudent.Name}" FontSize="16"/>
            </StackPanel>
            
            <Grid Grid.Row="1" ColumnDefinitions="*,*">
                <!-- Left Panel: Available Subjects -->
                <DockPanel Grid.Column="0" Margin="0,0,10,0">
                    <TextBlock DockPanel.Dock="Top" Text="Available Subjects" FontWeight="Bold" Margin="0,0,0,10"/>
                    <ListBox ItemsSource="{Binding AvailableSubjects}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,3" CornerRadius="3" Width="550">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <StackPanel Grid.Column="0" Spacing="4">
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                            <TextBlock Text="{Binding Description}" TextWrapping="Wrap" Opacity="0.8"/>
                                        </StackPanel>
                                        <Button Grid.Column="1"
                                                Content="Enroll" 
                                                Command="{Binding Source={x:Static vm:StudentWindowViewModel.Current}, Path=EnrollInSubjectCommand}" 
                                                CommandParameter="{Binding}"
                                                Margin="0,0,0,0"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </DockPanel>
                
                <!-- Right Panel: Enrolled Subjects and Details -->
                <DockPanel Grid.Column="1" Margin="10,0,0,0">
                    <TextBlock DockPanel.Dock="Top" Text="Enrolled Subjects" FontWeight="Bold" Margin="0,0,0,10"/>
                    
                    <Border DockPanel.Dock="Bottom" 
                            BorderBrush="Gray" 
                            BorderThickness="1" 
                            Padding="15" 
                            Margin="0,10,0,0"
                            CornerRadius="5"
                            IsVisible="{Binding IsViewingDetails}">
                        <Grid RowDefinitions="Auto,*">
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <TextBlock Text="Subject Details" FontWeight="Bold" VerticalAlignment="Center"/>
                                <Button Content="Close" 
                                        Command="{Binding CloseDetailsCommand}" 
                                        HorizontalAlignment="Right"
                                        Margin="10,0,0,0"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="1" Spacing="10">
                                <TextBlock Text="{Binding SelectedSubject.Name}" FontSize="18" FontWeight="Bold"/>
                                <TextBlock Text="{Binding SelectedSubject.Description}" TextWrapping="Wrap"/>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Teacher ID: " FontWeight="Bold"/>
                                    <TextBlock Text="{Binding SelectedSubject.TeacherId}"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <ListBox ItemsSource="{Binding EnrolledSubjects}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,3" CornerRadius="3" Width="550">
                                    <Grid ColumnDefinitions="*,Auto,Auto">
                                        <StackPanel Grid.Column="0" Spacing="4">
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <Button Content="View Details" 
                                                    Command="{Binding Source={x:Static vm:StudentWindowViewModel.Current}, Path=ViewSubjectDetailsCommand}" 
                                                    CommandParameter="{Binding}"
                                                    Margin="0,0,5,0"/>
                                            <Button Content="Drop" 
                                                    Command="{Binding Source={x:Static vm:StudentWindowViewModel.Current}, Path=DropSubjectCommand}" 
                                                    CommandParameter="{Binding}"
                                                    Margin="0,0,0,0"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </DockPanel>
            </Grid>
        </Grid>
    </Panel>
</Window>